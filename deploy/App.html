<!DOCTYPE html>
<html>
<head>
    <title>RallyTcReportTable</title>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){this._loadData()},_showTable:function(){var table=Ext.create("Ext.grid.Panel",{title:"Manual vs. Automated comparison table",store:Ext.data.StoreManager.lookup("simpsonsStore"),columns:[{text:"",dataIndex:"type",align:"left"},{text:"Manual",dataIndex:"manual",align:"center"},{text:"Automated",dataIndex:"auto",align:"center",flex:1},{text:"Total # of TC",dataIndex:"tc",align:"center"}],width:500,padding:15});this.add(table)},_createTable:function(obj){obj.type="All",Ext.create("Ext.data.Store",{storeId:"simpsonsStore",fields:["type","manual","auto","tc"],data:{items:obj},proxy:{type:"memory",reader:{type:"json",root:"items"}}}),obj.auto&&obj.manual&&obj.type&&obj.tc&&this._showTable()},_loadData:function(){var me=this,manualFilter=Ext.create("Rally.data.wsapi.Filter",{id:"manualCount",property:"Method",operation:"=",value:"Manual"}),automatedFilter=Ext.create("Rally.data.wsapi.Filter",{id:"automatedCount",property:"Method",operation:"=",value:"Automated"});me.arrayC={manual:"",auto:"",tc:""},[manualFilter,automatedFilter,manualFilter.or(automatedFilter)].forEach(function(filter){Ext.create("Rally.data.wsapi.Store",{model:"Test Case",autoLoad:!0,filters:filter,listeners:{load:function(myStore){switch(console.log(myStore),filter.id){case"manualCount":me.arrayC.manual=myStore.totalCount;break;case"automatedCount":me.arrayC.auto=myStore.totalCount;break;default:me.arrayC.tc=myStore.totalCount}me._createTable(me.arrayC)},scope:this},fetch:["Type","Method"]})})}});

            Rally.launchApp('CustomApp', {
                name:"RallyTcReportTable",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
